function [audio, fs]= FM_DEMOD_PEREYRA(x, fs, wn, d)% Demodula la señal x que esta modulada en FM% INPUTS:% x = señal de entrada.% fs = frecuencia de muestreo.% wn = frecuencia de corte normalizada . Donde wn=B/(fs/2) siendo %      B es el ancho de banda en hz.% d = factor de diezmado.% OUTPUTS:% fs = nueva frecuencia de muestreo despues de ser diezmada la señal.% audio = señal de audio demodulada y diezmada. % Filtrado de un canal de forma digitalord_filtro = 10; % Orden del filtroy = filtro_digital(x, ord_filtro, wn);%calc_DEP(y(:,1), fs,'fn');% Demodulación de FMz = abs(diff(y));% Se quita la continua de la señalaudio = z - mean(z);%calc_DEP(audio, fs, 'fn');% Filtrado en Banda Base audio = filtro_digital(audio, ord_filtro, 20e3/(fs/2));%calc_DEP(audio, fs, 'fn');% Graficar la señal de audio%figure%plot(audio)% Se aplica el diezmadoaudio = decimate(audio, d);%calc_DEP(audio, fs/d);fs = fs/d;end